<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>نرم افزار قیمت لحظه‌ای رمز ارزها</title>
    <script>
        // اگر هنوز وارد صفحه نشده، کلاس مخصوص لودینگ رو به HTML بده
        if (!sessionStorage.getItem('visited')) {
            document.documentElement.classList.add('show-loader');
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tahoma&display=swap');
        body {
            font-family: 'Tahoma', sans-serif;
        }.crypto-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .positive {
        color: #10B981;
    }

    .negative {
        color: #EF4444;
    }

    .blink {
        animation: blink 1s;
    }

    @keyframes blink {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    /* لودینگ */
    #loading-screen {
        display: none;
    }
    html.show-loader #loading-screen {
        display: flex;
    }
    .crypto-coin {
        animation: float 3s ease-in-out infinite;
    }
    .coin-shadow {
        animation: pulse 3s ease-in-out infinite;
    }
    .progress-bar {
        animation: progress 3s linear infinite;
    }
    @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(10deg); }
    }
    @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 0.5; }
        50% { transform: scale(0.8); opacity: 0.3; }
    }
    @keyframes progress {
        0% { width: 0%; background-color: #3b82f6; }
        50% { background-color: #8b5cf6; }
        100% { width: 100%; background-color: #ec4899; }
    }
    .bitcoin-pattern {
        background-image: radial-gradient(circle at 10px 10px, #f7931a 1px, transparent 1px),
                          radial-gradient(circle at 30px 30px, #f7931a 1px, transparent 1px);
        background-size: 40px 40px;
    }
    .ethereum-pattern {
        background-image: linear-gradient(45deg, #627eea 25%, transparent 25%),
                          linear-gradient(-45deg, #627eea 25%, transparent 25%),
                          linear-gradient(45deg, transparent 75%, #627eea 75%),
                          linear-gradient(-45deg, transparent 75%, #627eea 75%);
        background-size: 20px 20px;
    }
	 /* پیام خوشامدگویی */
	.welcome-message {
      background: linear-gradient(#7682F2, #9CC1FF ,#00D4FF);
      color: #fff;
      padding: 1rem;
      border-radius: 10px;
      margin: 1rem;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      display: none;
    }
</style>
</head>
<body class="bg-gray-100">
<!-- Loading Screen -->
<div id="loading-screen" class="fixed inset-0 bg-gray-900 text-white z-50 flex-col items-center justify-center hidden">
    <div class="relative flex justify-center mb-8">
        <div class="crypto-coin w-32 h-32 rounded-full relative z-10 flex items-center justify-center shadow-lg">
            <div class="absolute inset-0 rounded-full bitcoin-pattern"></div>
            <div class="absolute inset-0 rounded-full bg-black opacity-20"></div>
            <i class="fab fa-bitcoin text-5xl text-yellow-500 relative z-10"></i>
        </div>
        <div class="coin-shadow absolute bottom-0 w-24 h-6 bg-black rounded-full blur-md opacity-50"></div>
        <div class="absolute -right-4 top-1/2 transform -translate-y-1/2">
            <div class="w-12 h-12 rounded-full ethereum-pattern flex items-center justify-center shadow-md">
                <i class="fab fa-ethereum text-purple-500"></i>
            </div>
        </div>
        <div class="absolute -left-4 top-1/4">
            <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center shadow-md">
                <i class="fas fa-dollar-sign text-white text-xs"></i>
            </div>
        </div>
    </div>
    <h1 class="text-3xl font-bold mb-2 bg-gradient-to-r from-yellow-500 via-purple-500 to-blue-500 bg-clip-text text-transparent">
       درحال هدایت به صفحه AMIR
    </h1>
    <p class="text-gray-400 mb-6">در حال بارگذاری داده‌های بلاک‌چین...</p>
    <div class="w-64 bg-gray-800 rounded-full h-3 mb-6 overflow-hidden">
        <div class="progress-bar h-full rounded-full"></div>
    </div>
</div>

<div id="main-content" style="display: none;">
    <!-- هدر و منو -->
    <header class="bg-indigo-900 text-white shadow-md sticky top-0 z-50">
      <div class="container mx-auto px-4 py-4 flex justify-between items-center">
        <div class="text-2xl font-bold">
          <i class="fab fa-bitcoin mr-2"></i>
          رمز بازار
        </div>
        <div class="auth-buttons"></div>
		<!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-6 space-x-reverse">
                    <a href="#" class="hover:text-indigo-200">صفحه اصلی</a>
                    <a href="http://abedini806.freehost.io" class="hover:text-indigo-200">سایت های ما</a>
                    <a href="./akhbar.html" class="hover:text-indigo-200">اخبار</a>
					<a href="./nemodar.html" class="hover:text-indigo-200">نمودارها</a>
                    <a href="./darbare.html" class="hover:text-indigo-200">درباره ما</a>
                </nav>
                 
				 
				 
                <!-- Last Update -->
                <div class="flex items-center">
                    <span id="last-update" class="text-sm bg-indigo-800 px-3 py-1 rounded-full">
                        آخرین بروزرسانی: در حال دریافت...
                    </span>
                </div>
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="md:hidden text-white">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
      </div>
	<!-- پیام خوش‌آمدگویی -->
<main class="container mx-auto px-4 py-6">
  <div id="welcomeMessage" class="welcome-message">
    <h2><i class="fas fa-smile"></i> <span id="welcomeUsername"></span> عزیز، خوش آمدید!</h2>
  </div>
 </header>
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden bg-indigo-800 text-white md:hidden">
        <div class="container mx-auto px-4 py-2">
            <a href="#" class="block py-3 border-b border-indigo-700 hover:bg-indigo-700 px-2">صفحه اصلی</a>
            <a href="http://abedini806.freehost.io" class="block py-3 border-b border-indigo-700 hover:bg-indigo-700 px-2">سایت های ما</a>
            <a href="./akhbar.html" class="block py-3 border-b border-indigo-700 hover:bg-indigo-700 px-2">اخبار</a>
			<a href="./nemodar.html" class="block py-3 border-b border-indigo-700 hover:bg-indigo-700 px-2">نمودارها</a>
            <a href="./darbare.html" class="block py-3 hover:bg-indigo-700 px-2">درباره ما</a>
        </div>
    </div>
    
    <!-- Main Content -->
    <!-- دکمه‌های ورود و ثبت‌نام در هدر --><div class="auth-buttons"></div><!-- ... سایر بخش‌های HTML ... --><!-- قبل از </body> -->
        <!-- Market Overview -->
        <section class="mb-8">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">وضعیت کلی بازار</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">ارزش کل بازار:</span>
                            <span id="total-market-cap" class="font-bold">$1,234,567,890,123</span>
                        </div>
                        <div class="h-1 bg-gray-200 rounded-full mb-2">
                            <div class="h-1 bg-indigo-600 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">حجم معاملات 24h:</span>
                            <span id="total-volume" class="font-bold">$123,456,789,012</span>
                        </div>
                        <div class="h-1 bg-gray-200 rounded-full mb-2">
                            <div class="h-1 bg-green-500 rounded-full" style="width: 75%"></div>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">تعداد رمزارزها:</span>
                            <span id="total-cryptos" class="font-bold">12,345</span>
                        </div>
                        <div class="h-1 bg-gray-200 rounded-full mb-2">
                            <div class="h-1 bg-purple-500 rounded-full" style="width: 60%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Top Cryptos -->
        <section class="mb-8">
            <div class="bg-white rounded-xl shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">رمزارزهای برتر</h2>
                    <div class="flex items-center">
                        <span class="text-gray-600 mr-2">مرتب سازی بر اساس:</span>
                        <select id="sort-by" class="border border-gray-300 rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="market_cap">ارزش بازار</option>
                            <option value="volume">حجم معاملات</option>
                            <option value="price">قیمت</option>
                            <option value="change">تغییرات</option>
                        </select>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">#</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">نام</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">قیمت</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">تغییرات 24h</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">ارزش بازار</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">حجم معاملات</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">نمودار 7 روزه</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="crypto-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Crypto data will be loaded here -->
                            <tr>
                                <td colspan="8" class="px-6 py-4 text-center text-gray-500">در حال دریافت داده‌ها...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <!-- Popular Cryptos -->
        <section class="mb-8">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-xl font-bold mb-6 text-gray-800">رمزارزهای محبوب</h2>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Crypto cards will be loaded here -->
                    <div class="bg-gray-100 rounded-lg p-4 flex items-center justify-center h-32">
                        <i class="fas fa-spinner fa-spin text-gray-400 text-2xl"></i>
                    </div>
                    <div class="bg-gray-100 rounded-lg p-4 flex items-center justify-center h-32">
                        <i class="fas fa-spinner fa-spin text-gray-400 text-2xl"></i>
                    </div>
                    <div class="bg-gray-100 rounded-lg p-4 flex items-center justify-center h-32">
                        <i class="fas fa-spinner fa-spin text-gray-400 text-2xl"></i>
                    </div>
                    <div class="bg-gray-100 rounded-lg p-4 flex items-center justify-center h-32">
                        <i class="fas fa-spinner fa-spin text-gray-400 text-2xl"></i>
                    </div>
                </div>
            </div>
        </section>
        <!-- News Section -->
        <section class="mb-8">
            <div class="bg-white rounded-xl shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">آخرین اخبار رمزارزها</h2>
                    <a href="#" class="text-indigo-600 hover:text-indigo-800 flex items-center">
                        مشاهده همه
                        <i class="fas fa-arrow-left mr-2"></i>
                    </a>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition duration-300">
                        <img src="https://coiniran.com/wp-content/uploads/2017/01/88.jpg"style ="width:400px;height:200px;"alt="News" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <div class="text-sm text-gray-500 mb-2">۲ ساعت پیش</div>
                            <h3 class="font-bold mb-2 text-gray-800">بیت‌کوین به بالاترین سطح قیمتی ۶ ماه اخیر رسید</h3>
                            <p class="text-gray-600 text-sm mb-3">قیمت بیت‌کوین برای اولین بار پس از ۶ ماه از مرز ۵۰ هزار دلار گذشت و به ۵۱,۲۰۰ دلار رسید.</p>
                            <a href="./akhbar.html" class="text-indigo-600 text-sm font-medium">ادامه خبر</a>
                        </div>
                    </div>
                    <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition duration-300">
                        <img src="https://www.mydigipay.com/mag/wp-content/uploads/2024/10/crypto-bitcoin.jpg" style="width:400px;height:200px;"alt="News" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <div class="text-sm text-gray-500 mb-2">۵ ساعت پیش</div>
                            <h3 class="font-bold mb-2 text-gray-800">بیت کوین چیست؟</h3>
                            <p class="text-gray-600 text-sm mb-3"> اما سوال اینجاست که ارز دیجیتال بیت کوین چیست و چرا اینقدر در دنیای امروز مهم است؟</p>
                            <a href="./akhbar.html" class="text-indigo-600 text-sm font-medium">ادامه خبر</a>
                        </div>
                    </div>
                    <div class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition duration-300">
                        <img src="https://arzex.io/wp-content/uploads/2022/08/bitcoin-btc-hash-ribbon-indicator-prints-rare-bullish-signal.jpg"style="width:400px;height:200px;" alt="News" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <div class="text-sm text-gray-500 mb-2">۱ روز پیش</div>
                            <h3 class="font-bold mb-2 text-gray-800">رگولاتوری جدید در حوزه رمزارزها در راه است</h3>
                            <p class="text-gray-600 text-sm mb-3">مقامات مالی آمریکا در حال تدوین مقررات جدیدی برای بازار رمزارزها هستند که می‌تواند بر صنعت تأثیر بگذارد.</p>
                            <a href="./akhbar.html" class="text-indigo-600 text-sm font-medium">ادامه خبر</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="bg-violet-900 text-white pt-12 pb-6">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <!-- About -->
                <div>
                    <h3 class="text-xl font-bold mb-4">درباره رمز بازار</h3>
                    <p class="text-gray-400 mb-4">رمز بازار یک پلتفرم پیشرفته برای رصد لحظه‌ای قیمت رمزارزها و تحلیل بازارهای دیجیتال است.</p>
                    <div class="flex space-x-4 space-x-reverse">
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-telegram text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 class="text-xl font-bold mb-4">لینک‌های سریع</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">صفحه اصلی</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">رمزارزها</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">نمودارها</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">اخبار</a></li>
                    </ul>
                </div>
                
                <!-- Resources -->
                <div>
                    <h3 class="text-xl font-bold mb-4">منابع آموزشی</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">آموزش ترید</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">تحلیل تکنیکال</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">واژه نامه</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">پرسش‌های متداول</a></li>
                    </ul>
                </div>
</body>
</html>
    </footer>
    
    <!-- Back to Top Button -->
    <button id="back-to-top" class="fixed bottom-6 left-6 bg-indigo-600 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center hover:bg-indigo-700 transition duration-300 hidden">
        <i class="fas fa-arrow-up"></i>
    </button>
	  
	<script>
    const welcomeMessage = document.getElementById('welcomeMessage');
    const welcomeUsername = document.getElementById('welcomeUsername');
    const authButtons = document.querySelector('.auth-buttons');

    function checkAuthStatus() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));

      if (currentUser) {
        authButtons.innerHTML = `
          <button id="logoutBtn" class="btn btn-outline bg-red-600 text-indigo-700 px-4 py-2 rounded hover:bg-indigo-100">
            <i class="fas fa-sign-out-alt"></i> خروج
          </button>`;

        welcomeMessage.style.display = 'block';
        welcomeUsername.textContent = currentUser.name;
        setTimeout(() => {
          welcomeMessage.style.display = 'none';
        }, 5000);

        document.getElementById('logoutBtn').addEventListener('click', () => {
          localStorage.removeItem('currentUser');
          checkAuthStatus();
        });
      } else {
        authButtons.innerHTML = `
          <a href="form.html?mode=register" class="btn bg-violet-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            <i class="fas fa-user-plus"></i> ثبت‌نام
          </a>
          <a href="form.html?mode=login"
            <i class="fas fa-sign-in-alt"></i>
          </a>`;
        welcomeMessage.style.display = 'none';
      }
    }

    document.addEventListener('DOMContentLoaded', checkAuthStatus);
  </script>
	  
	  
	<!-- اسکریپت ثبت نام -->
    <script>
        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        // Back to Top Button
        const backToTopBtn = document.getElementById('back-to-top');
        
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.remove('hidden');
            } else {
                backToTopBtn.classList.add('hidden');
            }
        });
        
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Crypto Data Fetching
        let cryptoData = [];
        let popularCryptos = ['bitcoin', 'ethereum', 'ripple', 'cardano'];
        
        // Format numbers
        function formatNumber(num) {
            return new Intl.NumberFormat('en-US').format(num);
        }
        
        // Format currency
        function formatCurrency(num) {
            return new Intl.NumberFormat('en-US', { 
                style: 'currency', 
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 6
            }).format(num);
        }
        
        // Format percentage
        function formatPercentage(num) {
            return num.toFixed(2) + '%';
        }
        
        // Get crypto data from CoinGecko API
        async function fetchCryptoData() {
            try {
                // Show loading state
                document.getElementById('last-update').textContent = 'در حال دریافت داده‌ها...';
                
                // Fetch top 100 cryptos
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=true&price_change_percentage=24h');
                cryptoData = await response.json();
                
                // Update last update time
                const now = new Date();
                const timeString = now.toLocaleTimeString('fa-IR');
                document.getElementById('last-update').textContent = `آخرین بروزرسانی: ${timeString}`;
                
                // Update market overview
                updateMarketOverview();
                
                // Update crypto table
                updateCryptoTable();
                
                // Update popular cryptos
                updatePopularCryptos();
                
            } catch (error) {
                console.error('Error fetching crypto data:', error);
                document.getElementById('last-update').textContent = 'خطا در دریافت داده‌ها';
            }
        }
        
        // Update market overview
        function updateMarketOverview() {
            const totalMarketCap = cryptoData.reduce((sum, crypto) => sum + crypto.market_cap, 0);
            const totalVolume = cryptoData.reduce((sum, crypto) => sum + crypto.total_volume, 0);
            
            document.getElementById('total-market-cap').textContent = '$' + formatNumber(totalMarketCap);
            document.getElementById('total-volume').textContent = '$' + formatNumber(totalVolume);
            document.getElementById('total-cryptos').textContent = formatNumber(cryptoData.length);
        }
        
        // Update crypto table
        function updateCryptoTable() {
            const tableBody = document.getElementById('crypto-table-body');
            tableBody.innerHTML = '';
            
            // Sort cryptos based on selected option
            const sortBy = document.getElementById('sort-by').value;
            let sortedCryptos = [...cryptoData];
            
            if (sortBy === 'market_cap') {
                sortedCryptos.sort((a, b) => b.market_cap - a.market_cap);
            } else if (sortBy === 'volume') {
                sortedCryptos.sort((a, b) => b.total_volume - a.total_volume);
            } else if (sortBy === 'price') {
                sortedCryptos.sort((a, b) => b.current_price - a.current_price);
            } else if (sortBy === 'change') {
                sortedCryptos.sort((a, b) => b.price_change_percentage_24h - a.price_change_percentage_24h);
            }
            
            // Add rows to table
            sortedCryptos.slice(0, 10).forEach((crypto, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                // Determine price change class
                const changeClass = crypto.price_change_percentage_24h >= 0 ? 'positive' : 'negative';
                const changeIcon = crypto.price_change_percentage_24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                
                // Generate sparkline SVG
                const sparklinePoints = crypto.sparkline_in_7d.price;
                const minPrice = Math.min(...sparklinePoints);
                const maxPrice = Math.max(...sparklinePoints);
                const svgHeight = 30;
                const svgWidth = 100;
                
                let sparklinePath = '';
                sparklinePoints.forEach((price, i) => {
                    const x = (i / sparklinePoints.length) * svgWidth;
                    const y = svgHeight - ((price - minPrice) / (maxPrice - minPrice)) * svgHeight;
                    
                    if (i === 0) {
                        sparklinePath += `M ${x} ${y}`;
                    } else {
                        sparklinePath += ` L ${x} ${y}`;
                    }
                });
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-8 w-8">
                                <img class="h-8 w-8 rounded-full" src="${crypto.image}" alt="${crypto.name}">
                            </div>
                            <div class="mr-3">
                                <div class="text-sm font-medium text-gray-900">${crypto.name}</div>
                                <div class="text-sm text-gray-500">${crypto.symbol.toUpperCase()}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${formatCurrency(crypto.current_price)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${changeClass}">
                            <i class="fas ${changeIcon} mr-1"></i>
                            ${formatPercentage(crypto.price_change_percentage_24h)}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        $${formatNumber(crypto.market_cap)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        $${formatNumber(crypto.total_volume)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <svg width="${svgWidth}" height="${svgHeight}" viewBox="0 0 ${svgWidth} ${svgHeight}" class="stroke-current ${changeClass}" fill="none">
                            <path d="${sparklinePath}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <a href="#" class="text-indigo-600 hover:text-indigo-900 mr-2"><i class="fas fa-chart-line"></i></a>
                        <a href="#" class="text-indigo-600 hover:text-indigo-900"><i class="fas fa-bell"></i></a>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Update popular cryptos
        function updatePopularCryptos() {
            const popularContainer = document.querySelector('#popular-cryptos');
            
            // Clear loading state
            const popularSection = document.querySelector('section:nth-of-type(3) .grid');
            popularSection.innerHTML = '';
            
            // Add popular crypto cards
            popularCryptos.forEach(symbol => {
                const crypto = cryptoData.find(c => c.symbol === symbol.toLowerCase());
                if (crypto) {
                    const changeClass = crypto.price_change_percentage_24h >= 0 ? 'positive' : 'negative';
                    const changeIcon = crypto.price_change_percentage_24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                    
                    const card = document.createElement('div');
                    card.className = 'bg-white rounded-lg shadow-sm p-4 crypto-card transition duration-300';
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <img src="${crypto.image}" alt="${crypto.name}" class="w-8 h-8 mr-2">
                                <div>
                                    <h3 class="font-bold">${crypto.symbol.toUpperCase()}</h3>
                                    <p class="text-sm text-gray-500">${crypto.name}</p>
                                </div>
                            </div>
                            <span class="text-xs px-2 py-1 rounded-full ${changeClass}">
                                <i class="fas ${changeIcon} mr-1"></i>
                                ${formatPercentage(crypto.price_change_percentage_24h)}
                            </span>
                        </div>
                        <div class="text-xl font-bold mb-2">${formatCurrency(crypto.current_price)}</div>
                        <div class="h-20">
                            <svg width="100%" height="100%" viewBox="0 0 100 40" class="stroke-current ${changeClass}" fill="none">
                                <path d="${generateMiniSparkline(crypto.sparkline_in_7d.price)}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <div class="flex justify-between items-center mt-3 text-sm">
                            <span class="text-gray-500">ارزش بازار:</span>
                            <span class="font-medium">$${formatNumber(crypto.market_cap / 1000000)}M</span>
                        </div>
                    `;
                    
                    popularSection.appendChild(card);
                }
            });
        }
        
        // Generate simplified sparkline path
        function generateMiniSparkline(prices) {
            const minPrice = Math.min(...prices);
            const maxPrice = Math.max(...prices);
            const svgHeight = 40;
            const svgWidth = 100;
            
            let path = '';
            prices.forEach((price, i) => {
                const x = (i / prices.length) * svgWidth;
                const y = svgHeight - ((price - minPrice) / (maxPrice - minPrice)) * svgHeight;
                
                if (i === 0) {
                    path += `M ${x} ${y}`;
                } else {
                    path += ` L ${x} ${y}`;
                }
            });
            
            return path;
        }
        
        // Sort cryptos when select changes
        document.getElementById('sort-by').addEventListener('change', () => {
            updateCryptoTable();
        });
        
        // Initial fetch
        fetchCryptoData();
        
        // Update data every minute
        setInterval(fetchCryptoData, 60000);
        
        // Add blink animation to last update when updating
        setInterval(() => {
            const lastUpdate = document.getElementById('last-update');
            lastUpdate.classList.add('blink');
            
            setTimeout(() => {
                lastUpdate.classList.remove('blink');
            }, 1000);
        }, 60000);
    </script>
</div>

	<!-- فرم ثبتنام بالا -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const loadingScreen = document.getElementById('loading-screen');
        const mainContent = document.getElementById('main-content');

        if (document.documentElement.classList.contains('show-loader')) {
            // نمایش لودینگ فقط بار اول
            sessionStorage.setItem('visited', 'true');
            setTimeout(() => {
                loadingScreen.style.display = 'none';
                mainContent.style.display = 'block';
            }, 2500);
        } else {
            // دفعات بعد لودینگ نشون داده نشه
            mainContent.style.display = 'block';
        }
    });
</script>
</body>
</html>
